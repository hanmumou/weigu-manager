<template>
  <div class="app-container">
    <el-tabs class="money-container" type="card">
      <el-tab-pane label="提现管理">
        <!-- 提现管理页面 -->
        <div class="money-content">
          <el-form :inline="true" class="demo-form-inline">
            <!-- <el-radio :label="3" @change="toggleSelection(tableData3)">全选</el-radio> -->
            <el-button class="select-all" @click="toggleviplist(tableData3)">全选表格</el-button>
            <div class="export">
              <el-button size="medium" type="primary" @click="exportExcel">导出详情列表</el-button>
            </div>
            <el-form-item label="团长所在区域：">
              <el-input placeholder="请选择团长所在区域"/>
            </el-form-item>
            <el-form-item label="申请ID：">
              <el-input placeholder="请输入申请ID"/>
            </el-form-item>
            <el-form-item label="团长姓名：">
              <el-input placeholder="请输入团长姓名"/>
            </el-form-item>
            <el-form-item label="团长电话：">
              <el-input placeholder="请输入团长电话"/>
            </el-form-item>
            <el-form-item label="团长小区：">
              <el-input placeholder="请输入团长小区"/>
            </el-form-item>
            <el-form-item label="提现状态：">
              <el-select v-model="WD_status" />
            </el-form-item>
            <el-form-item label="开始日期：">
              <el-date-picker
                type="date"
                format="yyyy-MM-d"
                value-format="yyyy-MM-d"
                placeholder="开始日期"/>
            </el-form-item>
            <el-form-item label="结束日期：">
              <el-date-picker
                type="date"
                format="yyyy-MM-d"
                value-format="yyyy-MM-d"
                placeholder="结束日期"/>
            </el-form-item>
            <el-form-item>
              <el-button type="primary">查询</el-button>
              <el-button type="text">清空搜索</el-button>
            </el-form-item>
          </el-form>
        </div>
        <!-- 提现表格 -->
        <div>
          <el-table
            id="#exportexcel"
            ref="multipleTable"
            :xs="20"
            :data="tableData3"
            :row-class-name="tableRoWClassName"
            class="vip-listtable"
            tooltip-effect="dark"
            border
            style="width: 100%"
            @selection-change="handleSelectionChange">
            <el-table-column
              type="selection"
              align="center"/>
            <el-table-column
              prop="name"
              label="团长ID"
              align="center"/>
            <el-table-column
              prop="name"
              label="团长姓名"
              align="center"/>
            <el-table-column
              prop="name"
              align="center"
              width="130"
              label="团长电话"
              show-overflow-tooltip/>
            <el-table-column
              prop="phone"
              align="center"
              width="130"
              label="地区"
              show-overflow-tooltip/>
            <el-table-column
              prop="address"
              align="center"
              label="团长所在小区"
              show-overflow-tooltip/>
            <el-table-column
              prop="address"
              align="center"
              label="取货地址"
              show-overflow-tooltip/>
            <el-table-column
              prop="phone"
              align="center"
              label="总销售额"
              show-overflow-tooltip/>
            <el-table-column
              prop="phone"
              align="center"
              label="总提成"
              show-overflow-tooltip/>
            <el-table-column
              prop="phone"
              align="center"
              label="已提现"
              show-overflow-tooltip/>
            <el-table-column
              prop="phone"
              align="center"
              label="剩余提成"
              show-overflow-tooltip/>
            <el-table-column
              prop="phone"
              align="center"
              label="提现中"
              show-overflow-tooltip/>
            <el-table-column
              prop="phone"
              align="center"
              label="状态"
              show-overflow-tooltip/>
            <el-table-column label="操作" align="center">
              <template slot-scope="scope">
                <el-button type="danger" size="mini">手动发放</el-button>
                <el-button type="success" size="mini" >自动发放</el-button>
                <el-button type="infor" size="mini">不发放</el-button>
              </template>
            </el-table-column>
          </el-table>
        </div>
      </el-tab-pane>
      <!-- 提现管理结束 -->
      <el-tab-pane label="佣金明细">
        <!-- 佣金明细页面 -->
        <div class="manage-content">
          <el-form :inline="true" class="demo-form-inline">
            <!-- <el-radio :label="3" @change="toggleSelection(tableData3)">全选</el-radio> -->
            <el-button class="select-all" @click="toggleSelection(tableData4)">全选表格</el-button>
            <div class="export">
              <el-button size="medium" type="primary" @click="exportExcel">导出详情列表</el-button>
            </div>
            <el-form-item label="团长所在区域：">
              <!-- <el-select/> -->
            </el-form-item>
            <el-form-item label="申请ID：">
              <el-input placeholder="团长ID"/>
            </el-form-item>
            <el-form-item label="团长姓名：">
              <el-input placeholder="团长姓名"/>
            </el-form-item>
            <el-form-item label="团长电话：">
              <el-input placeholder="团长电话"/>
            </el-form-item>
            <el-form-item label="配送地址：">
              <el-input placeholder="团长小区"/>
            </el-form-item>
            <el-form-item label="选择产品：">
              <!-- <el-select/> -->
            </el-form-item>
            <el-form-item label="开始时间：">
              <el-date-picker
                type="date"
                format="yyyy-MM-d"
                value-format="yyyy-MM-d"
                placeholder="请输入订单开始时间"/>
            </el-form-item>
            <el-form-item label="结束时间：">
              <el-date-picker
                type="date"
                format="yyyy-MM-d"
                value-format="yyyy-MM-d"
                placeholder="请输入订单结束时间"/>
            </el-form-item>
            <el-form-item label="佣金状态">
              <!-- <el-select/> -->
            </el-form-item>
            <el-button type="primary">查询</el-button>
            <el-button type="text">清空搜索</el-button>
          </el-form>
        </div>
        <!-- 消费详情表格 -->
        <el-table
          id="#exportexcel"
          ref="multipleTable2"
          :xs="20"
          :data="tableData4"
          :row-class-name="tableRoWClassName"
          tooltip-effect="dark"
          border
          style="width: 100%"
          @selection-change="handleSelectionChange2">
          <el-table-column
            type="selection"
            align="center"/>
          <el-table-column
            prop="name"
            label="团长ID"
            align="center"/>
          <el-table-column
            prop="name"
            label="姓名"
            align="center"/>
          <el-table-column
            prop="name"
            align="center"
            width="130"
            label="电话"
            show-overflow-tooltip/>
          <el-table-column
            prop="phone"
            align="center"
            width="130"
            label="配送区域"
            show-overflow-tooltip/>
          <el-table-column
            prop="address"
            align="center"
            label="产品名称"
            show-overflow-tooltip/>
          <el-table-column
            prop="address"
            align="center"
            label="规格"
            show-overflow-tooltip/>
          <el-table-column
            prop="phone"
            align="center"
            label="数量"
            show-overflow-tooltip/>
          <el-table-column
            prop="phone"
            align="center"
            label="单价"
            show-overflow-tooltip/>
          <el-table-column
            prop="phone"
            align="center"
            label="合计"
            show-overflow-tooltip/>
          <el-table-column
            prop="phone"
            align="center"
            label="订单日期"
            show-overflow-tooltip/>
          <el-table-column
            prop="phone"
            align="center"
            label="佣金状态"
            show-overflow-tooltip/>
          <el-table-column
            prop="phone"
            align="center"
            label="佣金"
            show-overflow-tooltip/>
        </el-table>
        <!-- 合计 -->
        <p class="combined">合计：</p>
        <!-- 备注 -->
        <div class="note">
          <p>备注：</p>
          <p>预得佣金： 为以支付末发货的佣金</p>
          <p>已得佣金：为已完成交易的佣金 </p>
          <br>
          <p>交易完成流程：后台点发货，顾客手机端点确认收货，如顾客不点收货，自 后台点发货时起72小时默认完成交易</p>
        </div>
      </el-tab-pane>
    </el-tabs>
  </div>
</template>
<script>
import FileSaver from 'file-saver'
import XLSX from 'xlsx'
export default {
  data() {
    return {
      tableData3: [{
        date: '2016-05-03',
        name: '王小虎',
        address: '河北省石家庄裕华区翟营南大街新界南楼801我真的真的很长很长',
        phone: '18888888888'
      }, {
        date: '2016-05-02',
        name: '王小虎',
        address: '上海市普陀区金沙江路 大大 弄',
        phone: '18888888888'
      }, {
        date: '2016-05-04',
        name: '王小虎',
        address: '上海市普陀区金沙江路 1518 弄',
        phone: '18888888888'
      }, {
        date: '2016-05-01',
        name: '王小虎',
        address: '上海市普陀区金沙江路 1518 弄',
        phone: '18888888888'
      }, {
        date: '2016-05-08',
        name: '王小虎',
        address: '上海市普陀区金沙江路 1518 弄',
        phone: '18888888888'
      }, {
        date: '2016-05-06',
        name: '王小虎',
        address: '上海市普陀区金沙江路 1518 弄',
        phone: '18888888888'
      }, {
        date: '2016-05-07',
        name: '王小虎',
        address: '上海市普陀区金沙江路 1518 弄',
        phone: '18888888888'
      }],
      tableData4: [{
        date: '2016-05-03',
        name: '王小虎',
        address: '河北省石家庄裕华区翟营南大街新界南楼801我真的真的很长很长',
        phone: '18888888888'
      }, {
        date: '2016-05-02',
        name: '王小虎',
        address: '上海市普陀区金沙江路 大大 弄',
        phone: '18888888888'
      }, {
        date: '2016-05-04',
        name: '王小虎',
        address: '上海市普陀区金沙江路 1518 弄',
        phone: '18888888888'
      }, {
        date: '2016-05-01',
        name: '王小虎',
        address: '上海市普陀区金沙江路 1518 弄',
        phone: '18888888888'
      }, {
        date: '2016-05-08',
        name: '王小虎',
        address: '上海市普陀区金沙江路 1518 弄',
        phone: '18888888888'
      }, {
        date: '2016-05-06',
        name: '王小虎',
        address: '上海市普陀区金沙江路 1518 弄',
        phone: '18888888888'
      }, {
        date: '2016-05-07',
        name: '王小虎',
        address: '上海市普陀区金沙江路 1518 弄',
        phone: '18888888888'
      }],
      multipleSelection: [],
      multipleSelection2: [],
      WD_status: '' // 提现状态
    }
  },
  methods: {
  // 表格隔行显示不同颜色
    tableRoWClassName({ row, rowIndex }) {
      if ((rowIndex % 2) === 1) {
        return 'success-row'
      } else if ((rowIndex % 2) === 0) {
        return 'warning-row'
      }
    },
    // 会员列表的表格全选操作
    toggleviplist(rows) {
      if (rows) {
        rows.forEach(row => {
          this.$refs.multipleTable.toggleRowSelection(row)
        })
      } else {
        this.$refs.multipleTable.clearSelection()
      }
    },
    // 消费详情的表格全选操作
    toggleSelection(rows) {
      if (rows) {
        rows.forEach(row => {
          this.$refs.multipleTable2.toggleRowSelection(row)
        })
      } else {
        this.$refs.multipleTable2.clearSelection()
      }
    },
    handleSelectionChange(val) {
      this.multipleSelection = val
    },
    handleSelectionChange2(val) {
      this.multipleSelection2 = val
    },
    // 导出Excel
    exportExcel() {
      /* generate workbook object from table */
      const wb = XLSX.utils.table_to_book(document.getElementById('#exportexcel'))
      /* get binary string as output */
      const wbout = XLSX.write(wb, { bookType: 'xlsx', bookSST: true, type: 'array' })
      try {
        FileSaver.saveAs(new Blob([wbout], { type: 'application/octet-stream' }), '会员列表.xlsx')
      } catch (e) {
        if (typeof console !== 'undefined') {
          console.log(e, wbout)
        }
      }
      return wbout
    }
  }
}
</script>

<style>

/* 去除tab 标签边框 */
.money-container .el-tabs__header .el-tabs__nav{
  border: none;
}
.money-container .el-tabs__header{
  margin: 0;
}
/* tab标签活动选项 */
.money-container .el-tabs__item.is-active{
  background:#FE4643;
  color:#000;
}
.money-container .el-tabs__item:hover{
  color:#409EFF;
}
/* tab标签初始化样式 */
.money-container .el-tabs__item{
  font-size: 0.8rem;
  width: 8.42rem;
  height: 2.76rem;
  text-align: center;
  line-height: 2.76rem;
  border-radius: 16px 16px 0px 0px;
  background-color: #676767;
  color: #fff;
  margin-right: 10px;
}
.export{
  display: inline;
}
/* 提现管理样式 */
.money-content{
  width: 100%;
  padding-top: 20px;
  padding-left: 20px;
  /* padding:20px 20px 20px 10px; */
  background-color: rgb(48, 65, 86);
  box-sizing: border-box;
}
.money-content .el-form-item__label{
  color:#fff;
}

/* 会员列表页结束 */

/* 消费详情页开始 */

.manage-content{
  background-color: rgb(48, 65, 86);
  padding: 20px;
}
.manage-content .el-form-item__label{
  color:#fff;
}

/* 佣金明细页面select样式 */
.money-container .manage-content .el-select{
  width:170px;
}
/* 佣金明细页面日期框样式 */
.money-container .manage-content .el-date-editor{
  width:170px;
}
/* 合计文本样式 */
.money-container .combined{
  width:100%;
  text-align:right;
}
/* 备注 */
.money-container .note{
  width:812px;
  color:#BC1700;
}
</style>

